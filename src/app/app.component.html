<!-- src/app/chat/chat.component.html -->
<div class="chat-container">
  <button class="btn btn-primary chat-toggle" type="button" (click)="toggleChat()">
    Ouvrir le chat
  </button>

  <div class="chat-modal" [class.show]="showChat">
    <div class="chat-header">
      <h5 class="title">Assistant IA pour PDF</h5>
      <button type="button" class="btn-close" (click)="toggleChat()"></button>
    </div>
    <div class="chat-body">
      <div class="messages-container">
        @for (message of messages; track $index) {
          <div class="message" [class.sent]="message.sent" [class.received]="!message.sent">
            <div class="message-content">
              @if (message.isFile) {
                <div class="file-indicator">
                  <i class="bi bi-file-pdf"></i>
                  <span>{{ message.fileName }}</span>
                </div>
              }
              {{ message.text }}
            </div>
          </div>
        }
      </div>
    </div>
    <div class="chat-footer">
      @if (selectedFile) {
        <div class="selected-file">
          <span><i class="bi bi-file-pdf"></i> {{ selectedFile.name }}</span>
          <button class="btn btn-sm btn-danger" (click)="removeSelectedFile()">
            <i class="bi bi-x"></i>
          </button>
        </div>
      }
      <div class="input-group">
        <label class="btn btn-outline-secondary file-upload-btn">
          <i class="bi bi-paperclip"></i>
          <input
            type="file"
            class="d-none"
            accept=".pdf"
            #fileInput
            (change)="onFileSelected($event)">
        </label>
        <input
          type="text"
          class="form-control"
          placeholder="Posez une question sur votre PDF..."
          [(ngModel)]="newMessage"
          [disabled]="isLoading"
          (keyup.enter)="sendMessage()">
        <button
          class="btn btn-primary"
          type="button"
          [disabled]="isLoading"
          (click)="sendMessage()">
          @if (isLoading) {
            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
          } @else {
            <i class="bi bi-send"></i>
          }
        </button>
      </div>
      <div class="assistant-avatar">
        <img src="assets/assistant-avatar.png" alt="Assistant">
      </div>
    </div>
  </div>
</div>
